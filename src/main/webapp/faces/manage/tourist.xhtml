<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<ui:composition template="crud.xhtml">
    <ui:define name="title">#{msgs.tourist_manage}</ui:define>

    <ui:define name="toolbar">
        <p:commandButton value="#{msgs.add}" icon="pi pi-plus" actionListener="#{touristView.add}"
                         update=":dialogs:manage-entity-content" oncomplete="PF('manageEntityDialog').show()"
                         styleClass="ui-button-success" style="margin-right: .5rem">
            <p:resetInput target=":dialogs:manage-entity-content" />
        </p:commandButton>
        <p:commandButton id="delete-entities-button" value="#{touristView.deleteButtonMessage}"
                         icon="pi pi-trash" actionListener="#{touristView.deleteSelectedProducts}"
                         styleClass="ui-button-danger" disabled="#{!touristView.hasSelectedProducts()}" update="@this">
            <p:confirm header="#{msgs.confirm}" message="#{msgs.tourist_confirm_delete_p}"
                       icon="pi pi-exclamation-triangle" />
        </p:commandButton>
    </ui:define>

    <ui:define name="datatable">
        <p:dataTable id="entities" widgetVar="entities" var="entity" value="#{touristView.items}" stripedRows="true"
                     reflow="true" selection="#{touristView.selectedItems}" editable="true"
                     rowKey="#{entity.id}" paginator="true" rows="10" rowSelectMode="add" paginatorPosition="bottom">

            <f:facet name="header">
                <div class="p-d-flex p-jc-between p-ai-center">
                    <span style="font-weight: bold">#{msgs.tourists}</span>
                    <div>
                        <span class="ui-picklist-filter-container ui-input-icon-left" style="padding-right: 1rem">
                            <i class="pi pi-search"/>
                            <p:inputText id="globalFilter" onkeyup="PF('entities').filter()" placeholder="#{msgs.search}"/>
                        </span>
                        <p:commandButton id="toggler" type="button" value="#{msgs.columns}" icon="pi pi-align-justify"/>
                        <p:columnToggler datasource="entities" trigger="toggler">
                            <p:ajax />
                        </p:columnToggler>
                    </div>
                </div>
            </f:facet>

            <p:ajax event="rowSelect" update=":form:delete-entities-button" />
            <p:ajax event="rowUnselect" update=":form:delete-entities-button" />
            <p:ajax event="rowSelectCheckbox" update=":form:delete-entities-button" />
            <p:ajax event="rowUnselectCheckbox" update=":form:delete-entities-button" />
            <p:ajax event="toggleSelect" update=":form:delete-entities-button" />

            <p:column selectionMode="multiple" exportable="false" toggleable="false"/>

            <p:column headerText="#{msgs.name}" sortBy="#{entity.name}" filterBy="#{entity.name}">
                <h:outputText value="#{entity.name}"/>
            </p:column>
            <p:column headerText="#{msgs.passport}" sortBy="#{entity.passport}" filterBy="#{entity.passport}">
                <h:outputText value="#{entity.passport}"/>
            </p:column>
            <p:column headerText="#{msgs.age}" sortBy="#{entity.age}" filterBy="#{entity.age}">
                <h:outputText value="#{entity.age}"/>
            </p:column>
            <p:column headerText="#{msgs.gender}" sortBy="#{entity.gender.name}" filterBy="#{entity.gender.name}">
                <h:outputText value="#{entity.gender.name}"/>
            </p:column>
            <p:column headerText="#{msgs.contact}" sortBy="#{entity.contact}" filterBy="#{entity.contact}">
                <h:outputText value="#{entity.contact}"/>
            </p:column>
            <p:column headerText="#{msgs.country}" sortBy="#{entity.country.name}" filterBy="#{entity.country.name}">
                <h:outputText value="#{entity.country.name}"/>
            </p:column>

            <p:column headerText="#{msgs.options}" exportable="false" toggleable="false">
                <p:commandButton icon="pi pi-pencil" action="#{touristView.edit}" update=":dialogs:manage-entity-content"
                                 oncomplete="PF('manageEntityDialog').show()"
                                 styleClass="edit-button rounded-button ui-button-success" process="@this">
                    <f:setPropertyActionListener value="#{entity}" target="#{touristView.selectedItem}"/>
                    <p:resetInput target=":dialogs:manage-entity-content"/>
                </p:commandButton>
                <p:commandButton icon="pi pi-trash" styleClass="ui-button-warning rounded-button"
                                 process="@this" oncomplete="PF('deleteEntityDialog').show()">
                    <f:setPropertyActionListener value="#{entity}" target="#{touristView.selectedItem}"/>
                </p:commandButton>
            </p:column>

        </p:dataTable>
    </ui:define>

    <ui:define name="dialogs">
        <p:dialog header="#{msgs.tourist}" showEffect="fade" modal="true" widgetVar="manageEntityDialog"
                  responsive="true">
            <p:outputPanel id="manage-entity-content" styleClass="ui-fluid">
                <p:outputPanel rendered="#{not empty touristView.selectedItem}">
                    <h:panelGrid columns="3">
                        <p:outputLabel for="name" value="#{msgs.name}" style="padding-right: 0.5rem"/>
                        <p:inputText id="name" required="true" value="#{touristView.selectedItem.name}"/>
                        <p:message for="name" display="tooltip"/>

                        <p:outputLabel for="passport" value="#{msgs.passport}" style="padding-right: 0.5rem"/>
                        <p:inputText id="passport" required="true" value="#{touristView.selectedItem.passport}"/>
                        <p:message for="passport" display="tooltip"/>

                        <p:outputLabel for="age" value="#{msgs.age}" style="padding-right: 0.5rem"/>
                        <p:inputText id="age" required="true" value="#{touristView.selectedItem.age}"/>
                        <p:message for="age" display="tooltip"/>

                        <p:outputLabel for="gender" value="#{msgs.gender}" style="padding-right: 0.5rem"/>
                        <p:selectOneMenu id="gender" required="true" value="#{touristView.selectedGender}"
                                         hideNoSelectionOption="#{not empty touristView.selectedItem.gender.id}">
                            <p:ajax update="@this" process="@this"/>
                            <f:selectItem id="no_selection" noSelectionOption="true" itemLabel="#{msgs.gender}" value="#{null}"/>
                            <f:selectItems value="#{touristView.genders}" var="gender" itemLabel="#{gender.name}" itemValue="#{gender.id}"/>
                        </p:selectOneMenu>
                        <p:message for="gender" display="tooltip"/>

                        <p:outputLabel for="contact" value="#{msgs.contact}" style="padding-right: 0.5rem"/>
                        <p:inputText id="contact" required="true" value="#{touristView.selectedItem.contact}"/>
                        <p:message for="contact" display="tooltip"/>

                        <p:outputLabel for="country" value="#{msgs.country}" style="padding-right: 0.5rem"/>
                        <p:selectOneMenu id="country" required="true" value="#{touristView.selectedCountry}"
                                         hideNoSelectionOption="#{not empty touristView.selectedItem.country.id}">
                            <p:ajax update="@this" process="@this"/>
                            <f:selectItem id="no_selection1" noSelectionOption="true" itemLabel="#{msgs.country}" value="#{null}"/>
                            <f:selectItems value="#{touristView.countries}" var="country" itemLabel="#{country.name}" itemValue="#{country.id}"/>
                        </p:selectOneMenu>
                        <p:message for="country" display="tooltip"/>

                    </h:panelGrid>
                </p:outputPanel>
            </p:outputPanel>

            <f:facet name="footer">
                <div style="text-align: center">
                    <p:commandButton value="#{msgs.save}" icon="pi pi-check" actionListener="#{touristView.save}"
                                     update="manage-entity-content" process="manage-entity-content @this"/>
                    <p:commandButton value="#{msgs.cancel}" icon="pi pi-times" onclick="PF('manageEntityDialog').hide()"
                                     class="ui-button-secondary" type="button" />
                </div>
            </f:facet>
        </p:dialog>

        <p:confirmDialog widgetVar="deleteEntityDialog" showEffect="fade" width="300"
                         message="#{msgs.tourist_confirm_delete}" header="#{msgs.confirm}" severity="warn">
            <p:commandButton value="#{msgs.yes}" icon="pi pi-check" actionListener="#{touristView.delete}"
                             process="@this"
                             oncomplete="PF('deleteEntityDialog').hide()" />
            <p:commandButton value="#{msgs.no}" type="button" styleClass="ui-button-secondary" icon="pi pi-times"
                             onclick="PF('deleteEntityDialog').hide()" />
        </p:confirmDialog>

        <p:confirmDialog global="true" showEffect="fade" width="300">
            <p:commandButton value="#{msgs.yes}" type="button" styleClass="ui-confirmdialog-yes" icon="pi pi-check" />
            <p:commandButton value="#{msgs.no}" type="button" styleClass="ui-confirmdialog-no ui-button-secondary"
                             icon="pi pi-times" />
        </p:confirmDialog>
    </ui:define>
</ui:composition>
</html>
